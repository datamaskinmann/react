{"ast":null,"code":"import _slicedToArray from \"C:/Users/Svenn\\xE6rn/Desktop/laddel-mvp/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Svenn\\xE6rn\\\\Desktop\\\\laddel-mvp\\\\frontend\\\\src\\\\pages\\\\RegisterChargerMapPage.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport vectorDistance from \"../services/math/vectordistance\";\nimport { Geocode, Geolocation, ReverseGeocode } from \"../services/geo/geoService\";\nimport AddressSelectorMarker from \"../components/AddressSelectorMarker\";\nimport { MapConsumer, MapContainer, TileLayer } from 'react-leaflet';\nimport '../stylesheets/RegisterChargerMapPage.css';\nimport AddressSearchBar from \"../components/AddressSearchBar\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar RegisterChargerMapPage = function RegisterChargerMapPage() {\n  _s();\n\n  var _useState = useState([58.147582, 7.9971]),\n      _useState2 = _slicedToArray(_useState, 2),\n      position = _useState2[0],\n      setPosition = _useState2[1];\n\n  var _useState3 = useState(\"Henter addresse...\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      address = _useState4[0],\n      setAddress = _useState4[1];\n\n  var _useState5 = useState(11),\n      _useState6 = _slicedToArray(_useState5, 2),\n      zoom = _useState6[0],\n      setZoom = _useState6[1];\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"content\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        textAlign: \"center\"\n      },\n      className: \"laddelGreen\",\n      children: \"Legg til nytt ladepunkt\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(AddressSearchBar, {\n      callback: function callback(e) {\n        Geocode(e.address.value).then(function (x) {\n          var locations = JSON.parse(x).results[0].locations;\n\n          if (locations.length === 0) {\n            alert(\"Fant ikke adressen, vennligst prøv igjen.\");\n            return;\n          }\n\n          if (locations.length === 1) {\n            var selectedPos = locations[0].latLng;\n            setZoom(20);\n            setPosition([selectedPos.lat, selectedPos.lng]);\n            return;\n          }\n\n          Geolocation().then(function (x) {\n            var a = {\n              x: x.coords.latitude,\n              y: x.coords.longitude\n            };\n            locations = locations.sort(function (x, z) {\n              if (vectorDistance(a, {\n                x: x.latLng.lat,\n                y: x.latLng.lng\n              }) < vectorDistance(a, {\n                x: z.latLng.lat,\n                y: z.latLng.lng\n              })) {\n                return -1;\n              } else if (vectorDistance(a, {\n                x: x.latLng.lat,\n                y: x.latLng.lng\n              }) > vectorDistance(a, {\n                x: z.latLng.lat,\n                y: z.latLng.lng\n              })) {\n                return 1;\n              } else {\n                return 0;\n              }\n            });\n            setPosition([locations[0].latLng.lat, locations[0].latLng.lng]);\n            setZoom(20);\n          }).catch(function () {\n            setZoom(20);\n            setPosition([locations[0].latLng.lat, locations[0].latLng.lng]);\n          });\n        });\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 17\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map\",\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: position,\n        scrollWheelZoom: true,\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 17\n        }, _this), /*#__PURE__*/_jsxDEV(MapConsumer, {\n          children: function children(map) {\n            map.setView(position, zoom);\n            return null;\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 17\n        }, _this), /*#__PURE__*/_jsxDEV(AddressSelectorMarker, {\n          position: position,\n          address: address,\n          dragend: function dragend(e) {\n            return ReverseGeocode(e.lat, e.lng).then(function (x) {\n              setPosition([e.lat, e.lng]);\n              setZoom(20);\n\n              try {\n                var data = JSON.parse(x).results[0].locations[0];\n                var _address = data.street;\n\n                if (containsNumber(_address)) {\n                  _address = _address.split(\" \");\n                  var addressStringBuilder = \"\";\n\n                  for (var i = 1; i < _address.length; i++) {\n                    addressStringBuilder += _address[i] + \" \";\n                  }\n\n                  addressStringBuilder += _address[0];\n                  setAddress(addressStringBuilder);\n                } else {\n                  setAddress(_address);\n                }\n              } catch (error) {\n                console.log(error);\n                setAddress(\"Kunne ikke finne addressen...\");\n              }\n            });\n          },\n          callback: function callback() {\n            return window.location = \"/registercharger/\".concat(position[0], \"/\").concat(position[1], \"/\").concat(address);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 17\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 13\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 14,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(RegisterChargerMapPage, \"1D9xHsU38dcmAkNKGypy7hyPzMI=\");\n\n_c = RegisterChargerMapPage;\n\nvar containsNumber = function containsNumber(string) {\n  return /\\d/.test(string);\n};\n\nexport default RegisterChargerMapPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegisterChargerMapPage\");","map":{"version":3,"sources":["C:/Users/Svennærn/Desktop/laddel-mvp/frontend/src/pages/RegisterChargerMapPage.js"],"names":["React","useState","vectorDistance","Geocode","Geolocation","ReverseGeocode","AddressSelectorMarker","MapConsumer","MapContainer","TileLayer","AddressSearchBar","RegisterChargerMapPage","position","setPosition","address","setAddress","zoom","setZoom","textAlign","e","value","then","x","locations","JSON","parse","results","length","alert","selectedPos","latLng","lat","lng","a","coords","latitude","y","longitude","sort","z","catch","map","setView","data","street","containsNumber","split","addressStringBuilder","i","error","console","log","window","location","string","test"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\r\nimport vectorDistance from \"../services/math/vectordistance\";\r\nimport {Geocode, Geolocation, ReverseGeocode} from \"../services/geo/geoService\";\r\nimport AddressSelectorMarker from \"../components/AddressSelectorMarker\";\r\nimport {MapConsumer, MapContainer, TileLayer} from 'react-leaflet';\r\nimport '../stylesheets/RegisterChargerMapPage.css';\r\nimport AddressSearchBar from \"../components/AddressSearchBar\";\r\n\r\nconst RegisterChargerMapPage = () => {\r\n    const [position, setPosition] = useState([58.147582, 7.9971]);\r\n    const [address, setAddress] = useState(\"Henter addresse...\");\r\n    const [zoom, setZoom] = useState(11);\r\n    return (\r\n        <div className=\"content\">\r\n            <h1 style={{textAlign: \"center\"}} className={\"laddelGreen\"}>Legg til nytt ladepunkt</h1>\r\n                <AddressSearchBar callback={(e) => {\r\n                    Geocode(e.address.value).then(x => {\r\n                        let locations = JSON.parse(x).results[0].locations;\r\n\r\n                        if (locations.length === 0) {\r\n                            alert(\"Fant ikke adressen, vennligst prøv igjen.\");\r\n                            return;\r\n                        }\r\n\r\n                        if (locations.length === 1) {\r\n                            let selectedPos = locations[0].latLng;\r\n\r\n                            setZoom(20);\r\n                            setPosition([selectedPos.lat, selectedPos.lng]);\r\n                            return;\r\n                        }\r\n\r\n                        Geolocation().then(x => {\r\n                            let a = {x: x.coords.latitude, y: x.coords.longitude};\r\n\r\n                            locations = locations.sort((x, z) => {\r\n                                if (vectorDistance(a, {x: x.latLng.lat, y: x.latLng.lng}) <\r\n                                    vectorDistance(a, {x: z.latLng.lat, y: z.latLng.lng})) {\r\n                                    return -1\r\n                                } else if (vectorDistance(a, {x: x.latLng.lat, y: x.latLng.lng}) >\r\n                                    vectorDistance(a, {x: z.latLng.lat, y: z.latLng.lng})) {\r\n                                    return 1;\r\n                                } else {\r\n                                    return 0;\r\n                                }\r\n                            });\r\n\r\n                            setPosition([locations[0].latLng.lat, locations[0].latLng.lng]);\r\n                            setZoom(20);\r\n                        }).catch(() => {\r\n                            setZoom(20);\r\n                            setPosition([locations[0].latLng.lat, locations[0].latLng.lng]);\r\n                        });\r\n                    });\r\n                }}/>\r\n            <div className=\"map\">\r\n            <MapContainer center={position} scrollWheelZoom={true}>\r\n                <TileLayer\r\n                    attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                />\r\n                <MapConsumer>\r\n                    {(map) => {\r\n                        map.setView(position, zoom);\r\n                        return null;\r\n                    }}\r\n                </MapConsumer>\r\n                <AddressSelectorMarker position={position} address={address}\r\n                                 dragend={(e) => ReverseGeocode(e.lat, e.lng).then(x => {\r\n                                     setPosition([e.lat, e.lng]);\r\n                                     setZoom(20);\r\n                                     try {\r\n                                         let data = JSON.parse(x).results[0].locations[0];\r\n                                         let address = data.street;\r\n\r\n                                         if (containsNumber(address)) {\r\n                                             address = address.split(\" \");\r\n                                             let addressStringBuilder = \"\";\r\n\r\n                                             for (let i = 1; i < address.length; i++) {\r\n                                                 addressStringBuilder += (address[i] + \" \");\r\n                                             }\r\n\r\n                                             addressStringBuilder += address[0];\r\n\r\n                                             setAddress(addressStringBuilder);\r\n                                         } else {\r\n                                             setAddress(address);\r\n                                         }\r\n                                     } catch\r\n                                         (error) {\r\n                                         console.log(error);\r\n                                         setAddress(\"Kunne ikke finne addressen...\");\r\n                                     }\r\n                                 })} callback={() => window.location = `/registercharger/${position[0]}/${position[1]}/${address}`}/>\r\n\r\n            </MapContainer>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst containsNumber = (string) => {\r\n    return /\\d/.test(string);\r\n}\r\n\r\nexport default RegisterChargerMapPage;"]},"metadata":{},"sourceType":"module"}